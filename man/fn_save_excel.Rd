% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_save_excel.R
\name{fn_save_excel}
\alias{fn_save_excel}
\title{Save an Excel workbook with automatic fallback to temporary file}
\usage{
fn_save_excel(
  wb,
  path,
  filename,
  overwrite = TRUE,
  temp_suffix = "(TEMP Version)",
  quiet = FALSE,
  suppress_messages = TRUE,
  create_dir = TRUE
)
}
\arguments{
\item{wb}{A workbook object created with createWorkbook() from the openxlsx package}

\item{path}{The directory where the file should be saved}

\item{filename}{The name of the file to save (without the path)}

\item{overwrite}{Logical. If TRUE, overwrites the file if it exists. Default is TRUE.}

\item{temp_suffix}{Character. The suffix to append to filename for temporary versions. Default is "(TEMP Version)".}

\item{quiet}{Logical. If TRUE, suppresses informational messages. Default is FALSE.}

\item{suppress_messages}{Logical. If TRUE, suppresses permission denied warnings when checking files. Default is TRUE.}

\item{create_dir}{Logical. If TRUE, creates the directory if it doesn't exist. Default is TRUE.}
}
\value{
The full path to the saved file (either the original target or the temporary version)
}
\description{
This function attempts to save an Excel workbook to the specified path. If the target file
is locked or inaccessible, it will save a temporary version with a custom suffix.
It attempts to clean up previous temporary files before saving, and if temporary files
cannot be deleted, it will create a new temporary file with an incremented number.
By default, it will create the target directory if it doesn't exist.
}
\examples{
\dontrun{
# Create a workbook and add data
wb <- createWorkbook()
addWorksheet(wb, "Sheet1")
writeData(wb, "Sheet1", data.frame(x = 1:5, y = letters[1:5]))

# Save the workbook with default settings
fn_save_excel(wb, "output/reports", "Data.xlsx")

# Save with custom temporary suffix
fn_save_excel(wb, "output/reports", "Data.xlsx", temp_suffix = "(BACKUP)")
}

}

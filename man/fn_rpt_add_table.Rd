% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_rpt_add_table.R
\name{fn_rpt_add_table}
\alias{fn_rpt_add_table}
\title{Add a table with accompanying caption}
\usage{
fn_rpt_add_table(
  report = NULL,
  table = NULL,
  table_count = NULL,
  caption = NULL,
  stop_trailing_line = FALSE,
  stop_flextable_conversion = FALSE,
  vertical_lines = NULL,
  horizontal_lines = NULL,
  ...
)
}
\arguments{
\item{report}{The Officer report object.}

\item{table}{The table to be added. It can be a `data.frame` or an already converted `flextable`.}

\item{table_count}{The variable storing the current number of tables in the report (integer, usually named `count_tab`).}

\item{caption}{The caption to add above the table (string).}

\item{stop_trailing_line}{Logical. If `TRUE`, no empty line is added after the table. Defaults to `FALSE`.}

\item{stop_flextable_conversion}{Logical. If `TRUE`, the table is assumed to be a `flextable` and no conversion is performed. Defaults to `FALSE`.}

\item{vertical_lines}{A numeric vector specifying the columns where vertical lines should be added. Defaults to `NULL`.}

\item{horizontal_lines}{A numeric vector specifying the rows where horizontal lines should be added. Defaults to `NULL`.}

\item{...}{Additional arguments passed to `officer::body_add_flextable()`, such as text alignment (`align = "left"`).}
}
\value{
The function returns the updated Officer report object with the added table and caption. The `table_count` variable in the global environment is incremented by 1.
}
\description{
This function adds a `flextable` (with `autofit` layout by default) to an Officer report, along with a caption placed above the table. It supports adding vertical and horizontal lines to specific columns and rows.
}
\examples{
# Create an example Officer report
library(officer)
library(flextable)

# Example data frame
test_df <- data.frame(
  Column1 = c("A", "B", "C", "D"),
  Column2 = c(10, 20, 30, 40),
  Column3 = c(TRUE, FALSE, TRUE, FALSE)
)

# Initialize Officer report
rpt <- read_docx()

# Initialize table counter
count_tab <- 1

# Add the test_df as a table to the report
rpt <- fn_rpt_add_table(
  report = rpt,
  table = test_df,
  table_count = count_tab,
  caption = "Example Table Caption",
  vertical_lines = c(2),        # Add a vertical line after Column 2
  horizontal_lines = c(3),      # Add a horizontal line after Row 3
  stop_trailing_line = FALSE
)
}

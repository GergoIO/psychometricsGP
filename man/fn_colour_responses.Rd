% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_colour_responses.R
\name{fn_colour_responses}
\alias{fn_colour_responses}
\title{Highlight Correct and Incorrect Answers in Assessment Data}
\usage{
fn_colour_responses(
  data,
  col_correct_answer = "CorrectResponse",
  col_item_category = "ItemCategory",
  prefix_mcq = "MCQ_Option_",
  prefix_vsaq = "VSAQ_",
  colour_correct = "lightgreen",
  colour_incorrect = c("lightpink"),
  add_colour_correct = TRUE,
  add_colour_incorrect = c(TRUE)
)
}
\arguments{
\item{data}{A data frame or flextable containing assessment data}

\item{col_correct_answer}{Character. The name of the column containing correct answer indicators.
Default is "CorrectResponse". Can be NULL for VSAQ-only datasets.}

\item{col_item_category}{Character. The name of the column indicating item types.
Default is "ItemCategory".}

\item{prefix_mcq}{Character. The prefix for MCQ option columns. Default is "MCQ_Option_".}

\item{prefix_vsaq}{Character. The prefix for VSAQ columns. Default is "VSAQ_".}

\item{colour_correct}{Character. The color to use for correct answers. Default is "lightgreen".}

\item{colour_incorrect}{Character vector. The colors to use for incorrect answers, in order of
rank (highest value first). Default is c("lightpink").}

\item{add_colour_correct}{Logical. Whether to highlight correct answers. Default is TRUE.}

\item{add_colour_incorrect}{Logical vector. Whether to highlight incorrect answers, by rank.
Default is c(TRUE). Must be the same length as colour_incorrect.}
}
\value{
A flextable object with highlighting applied based on the specified parameters.
}
\description{
Creates a flextable with colored highlighting to indicate correct and incorrect answers
in assessment data. Supports both MCQ (Multiple Choice Questions) and VSAQ (Very Short
Answer Questions) formats. For MCQ items, highlights correct answers and can optionally
highlight incorrect answers by rank of their values. For VSAQ items, highlights the
"Correct" and "Incorrect" columns.
}
\details{
The function supports two types of assessment items:

1. MCQ (Multiple Choice Questions): For these items, the function uses the value in
   `col_correct_answer` to identify which option is correct (e.g., if CorrectResponse = 3,
   then MCQ_Option_3 is the correct answer). Incorrect answers are ranked by their values
   and colored according to the `colour_incorrect` vector.

2. VSAQ (Very Short Answer Questions): For these items, the function looks for columns
   named `prefix_vsaq + "Correct"` and `prefix_vsaq + "Incorrect"` and highlights them
   according to the `colour_correct` and `colour_incorrect` settings.

The function automatically handles input validation, including checking for required columns
and handling mismatches between `colour_incorrect` and `add_colour_incorrect` lengths.
}
\examples{
# Load required libraries
library(dplyr)
library(flextable)

# Create example data
df <- tibble(
  ItemCategory = c("MCQ", "MCQ", "VSAQ", "MCQ", "VSAQ"),
  CorrectResponse = c(4, 2, NA, 3, NA),
  MCQ_Option_1 = c(0.1, 0.2, 0, 0.3, 0),
  MCQ_Option_2 = c(0.2, 0.7, 0, 0.1, 0),
  MCQ_Option_3 = c(0.3, 0.1, 0, 0.6, 0),
  MCQ_Option_4 = c(0.8, 0.0, 0, 0.2, 0),
  VSAQ_Correct = c(NA, NA, 0.8, NA, 0.9),
  VSAQ_Incorrect = c(NA, NA, 0.2, NA, 0.5)
)

# Basic usage - highlight only correct answers
ft1 <- fn_colour_responses(df)

# Using vectors for incorrect colors - highlight top 3 incorrect answers
ft2 <- fn_colour_responses(
  data = df,
  colour_correct = "lightgreen",
  colour_incorrect = c("pink", "lightyellow", "lightblue"),
  add_colour_correct = TRUE,
  add_colour_incorrect = c(TRUE, TRUE, TRUE)
)

# Many MCQ options example
many_options_df <- tibble(
  ItemCategory = c("MCQ", "MCQ"),
  CorrectResponse = c(7, 3),
  MCQ_Option_1 = c(0.1, 0.1),
  MCQ_Option_2 = c(0.2, 0.2),
  MCQ_Option_3 = c(0.3, 0.7),
  MCQ_Option_4 = c(0.1, 0.3),
  MCQ_Option_5 = c(0.05, 0.1),
  MCQ_Option_6 = c(0.15, 0.05),
  MCQ_Option_7 = c(0.7, 0.05),
  MCQ_Option_8 = c(0.05, 0.05)
)
ft3 <- fn_colour_responses(
  data = many_options_df,
  colour_incorrect = c("pink", "lightyellow"),
  add_colour_incorrect = c(TRUE, TRUE)
)

# VSAQ-only dataset
vsaq_only_df <- tibble(
  ItemCategory = c("VSAQ", "VSAQ"),
  VSAQ_Correct = c(0.8, 0.9),
  VSAQ_Incorrect = c(0.2, 0.1)
)
ft4 <- fn_colour_responses(
  data = vsaq_only_df,
  col_correct_answer = NULL  # No correct answer column needed for VSAQ only
)

# Use with existing flextable
ft5 <- flextable(df) \%>\%
  bold(j = "ItemCategory") \%>\%
  fn_colour_responses(
    colour_correct = "lightblue",
    colour_incorrect = c("lightsalmon"),
    add_colour_incorrect = c(TRUE)
  )

}

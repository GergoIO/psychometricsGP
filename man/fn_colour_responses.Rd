% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_colour_responses.R
\name{fn_colour_responses}
\alias{fn_colour_responses}
\title{Highlight Correct and Incorrect Answers in Assessment Data}
\usage{
fn_colour_responses(
  data,
  colname_correct_answer = "CorrectResponse",
  colname_item_category = "ItemCategory",
  prefix_mcq = "MCQ_Option_",
  prefix_non_mcq = "Non-MCQ_",
  colour_correct = "lightgreen",
  colour_incorrect = c("lightpink"),
  highlight_correct = TRUE,
  highlight_top_n_incorrect = 1,
  min_value_threshold = 0,
  border_correct = FALSE,
  border_top_incorrect = FALSE,
  bold_correct = FALSE,
  bold_top_incorrect = FALSE,
  horizontal_lines = NULL,
  vertical_lines = NULL,
  border_colour = "black",
  border_width = 1.5,
  line_colour = "grey40",
  line_width = 1
)
}
\arguments{
\item{data}{A data frame or flextable containing assessment data}

\item{colname_correct_answer}{Character. The name of the column containing correct answer indicators.
Default is "CorrectResponse". Can be NULL for Non-MCQ-only datasets.}

\item{colname_item_category}{Character. The name of the column indicating item types.
Default is "ItemCategory".}

\item{prefix_mcq}{Character. The prefix for MCQ option columns. Default is "MCQ_Option_".}

\item{prefix_non_mcq}{Character. The prefix for Non-MCQ columns. Default is "Non-MCQ_".}

\item{colour_correct}{Character. The color to use for correct answers. Default is "lightgreen".}

\item{colour_incorrect}{Character vector. Colors to create gradient for incorrect answers.
Colors will be interpolated if more highlights are requested than colors provided.}

\item{highlight_correct}{Logical. Whether to highlight correct answers. Default is TRUE.}

\item{highlight_top_n_incorrect}{Numeric. Number of top incorrect answers to highlight.
Default is 1.}

\item{min_value_threshold}{Numeric. Minimum value threshold for highlighting incorrect answers.
Default is 0.}

\item{border_correct}{Logical. Whether to add border to correct answers. Default is FALSE.}

\item{border_top_incorrect}{Logical. Whether to add border to top incorrect answer. Default is FALSE.}

\item{bold_correct}{Logical. Whether to bold correct answers. Default is FALSE.}

\item{bold_top_incorrect}{Logical. Whether to bold top incorrect answer. Default is FALSE.}

\item{horizontal_lines}{Numeric vector. Row indices where horizontal lines should be added.
Default is NULL (no lines).}

\item{vertical_lines}{Numeric vector. Column indices where vertical lines should be added.
Default is NULL (no lines).}

\item{border_colour}{Character. Color for borders around correct and incorrect answers.
Default is "black".}

\item{border_width}{Numeric. Width for borders around correct and incorrect answers.
Default is 1.5.}

\item{line_colour}{Character. Color for horizontal and vertical lines.
Default is "black".}

\item{line_width}{Numeric. Width for horizontal and vertical lines.
Default is 1.}
}
\value{
A flextable object with highlighting applied based on the specified parameters.
}
\description{
Creates a flextable with colored highlighting to indicate correct and incorrect answers
in assessment data. Supports both MCQ (Multiple Choice Questions) and Non-MCQ (Very Short
Answer Questions) formats. For MCQ items, highlights correct answers and creates a smooth
color gradient for top incorrect answers based on their values.
}
\examples{
# Load required libraries
library(dplyr)
library(flextable)
library(colorRamp2)

# Create example data
df <- tibble(
  ItemCategory = c("MCQ", "MCQ", "Non-MCQ", "MCQ", "Non-MCQ"),
  CorrectResponse = c(4, 2, NA, 3, NA),
  MCQ_Option_1 = c(0.1, 0.2, 0, 0.3, 0),
  MCQ_Option_2 = c(0.2, 0.7, 0, 0.1, 0),
  MCQ_Option_3 = c(0.3, 0.1, 0, 0.6, 0),
  MCQ_Option_4 = c(0.8, 0.0, 0, 0.2, 0),
  Non_MCQ_Correct = c(NA, NA, 0.8, NA, 0.9),
  Non_MCQ_Incorrect = c(NA, NA, 0.2, NA, 0.5)
)

# Basic usage with custom lines and borders
ft1 <- fn_colour_responses(
  data = df,
  colour_incorrect = c("red", "orange", "yellow"),
  highlight_top_n_incorrect = 3,
  bold_correct = TRUE,
  bold_top_incorrect = TRUE,
  horizontal_lines = c(2, 4),
  vertical_lines = c(3, 5),
  border_colour = "navy",
  line_colour = "grey",
  border_width = 2,
  line_width = 0.5
)

}

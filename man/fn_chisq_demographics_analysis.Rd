% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_chisq_demographics_analysis.R
\name{fn_chisq_demographics_analysis}
\alias{fn_chisq_demographics_analysis}
\title{Perform Chi-Square Analysis of Demographics vs Pass/Fail Rates}
\usage{
fn_chisq_demographics_analysis(
  data,
  col_stage_current,
  cols_demographics,
  min_subgroup_n = 5,
  verbose_stats = TRUE,
  include_ci = TRUE,
  overall_test = TRUE,
  use_binary_fallback = TRUE,
  binary_on_any_exclusion = TRUE,
  entry_override = NULL
)
}
\arguments{
\item{data}{A data frame containing the dataset with demographic variables,
Grade, and ScorePct columns}

\item{col_stage_current}{Character string specifying the column name for stages}

\item{cols_demographics}{Character vector of demographic column names to analyze}

\item{min_subgroup_n}{Minimum number of students required in each Pass/Fail
category for a subgroup to be included. Default is 5}

\item{verbose_stats}{Logical indicating whether to include detailed chi-square
statistics or just p-values. Default is FALSE}

\item{include_ci}{Logical indicating whether to include confidence intervals
for pass rates. Default is TRUE}

\item{overall_test}{Logical indicating whether to perform overall chi-square
test for each demographic. Default is TRUE}

\item{use_binary_fallback}{Logical indicating whether to use binary comparison
(most common vs others) when original analysis fails due to small groups.
Default is TRUE}

\item{binary_on_any_exclusion}{Logical indicating whether to use binary fallback
if ANY subgroup needs to be excluded (not just when analysis completely fails).
Default is FALSE}

\item{entry_override}{Character string specifying a demographic name that should
use "Foundation" vs "Not Foundation" comparison instead of other approaches.
Default is NULL}
}
\value{
A list containing:
\describe{
  \item{results_tables}{List of tibbles, one per demographic, with subgroup
    statistics including count, observed mean score, pass rate, and confidence intervals}
  \item{exclusion_summary}{Tibble summarizing exclusions per demographic}
  \item{overall_tests}{Tibble with overall chi-square test results per demographic}
}
}
\description{
This function performs chi-square tests for each demographic factor against
pass/fail rates derived from Grade data. It handles minimum group size requirements
and can fallback to binary comparisons when needed.
}
\examples{
# Assuming your data structure
results <- fn_chisq_demographics_analysis(
  data = demographics_sitting |>
    filter(StageCurrent \%in\% demographics$anovas$stages) |>
    left_join(universal_students |>
              select(StudentID, Grade, ScorePct), by = "StudentID") |>
    filter(!is.na(Grade)),
  col_stage_current = "StageCurrent",
  cols_demographics = demographics$anovas$included,
  min_subgroup_n = 5,
  verbose_stats = FALSE,
  include_ci = TRUE,
  overall_test = TRUE,
  use_binary_fallback = TRUE,
  binary_on_any_exclusion = FALSE,
  entry_override = NULL
)

}
